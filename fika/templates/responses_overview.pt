<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="view.macro('arche:templates/base_view.pt')"
      i18n:domain="fika">
<body>

<div metal:fill-slot="main-content">

	<p>
		<a class="btn btn-default" href="${request.resource_url(context)}" role="button"><span class="glyphicon glyphicon-bookmark"></span> Back to course</a>
	</p>
	
    <tal:iterate repeat="question answers">
    	<p>
	    	<div class="panel-group" id="accordion-${question}" role="tablist" aria-multiselectable="true">
				<div class="panel panel-default">
					<div class="panel-heading" role="tab">
						<h4 class="panel-title">
							<a data-toggle="collapse" data-parent="#accordion-${question}" href="#collapse-${question}" aria-expanded="true" aria-controls="collapse-${question}"
								tal:content="structure view.resolve_uid(question).title"></a>
								<span class="badge pull-right"><span class="glyphicon glyphicon-comment"></span> ${len(view.resolve_uid(question).values())}</span>
						</h4>
					</div>
					<div id="collapse-${question}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
						<div class="panel-body" tal:content="structure view.resolve_uid(question).question"></div>
						
						<table class="table table-hover">
			    		<thead>
			    			<tr>
			    				<th><span i18n:translate="">User</span></th>
			    				<th><span i18n:translate="">Answer</span></th>
			    				<th><span i18n:translate="">Last modified</span></th>
			    			</tr>
			    		</thead>
			    		<tbody class="table-striped">
					    	<tal:iterate repeat="answer answers[question]">
					    		<tr>
					    			<td>
					    				<a href="${request.resource_url(view.resolve_uid(view.resolve_uid(answer).user_uid))}">
					    					${view.resolve_uid(view.resolve_uid(answer).user_uid).title}
					    				</a>
					    			</td>
					    			<td>${view.resolve_uid(answer).answer}</td>
					    			<td>
						    			<span tal:condition="getattr(view.resolve_uid(answer), 'modified', None)"
								            title="${request.dt_handler.format_dt(view.resolve_uid(answer).modified)}">
								            ${request.dt_handler.format_relative(view.resolve_uid(answer).modified)}
								        </span>
								        <span tal:condition="not getattr(view.resolve_uid(answer), 'modified', None) and getattr(view.resolve_uid(answer), 'created', None)"
								            title="${request.dt_handler.format_dt(view.resolve_uid(answer).created)}">
								            ${request.dt_handler.format_relative(view.resolve_uid(answer).created)}
								        </span>
							        </td>
					    		</tr>
					    	</tal:iterate>
				    	</tbody> 
					</table>
					</div>
					
				</div>
			</div>
    	</p>
    </tal:iterate> 
</div>

</body>
</html>
